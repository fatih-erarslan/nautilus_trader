[package]
name = "neuro-divergent"
version.workspace = true
edition.workspace = true
authors.workspace = true
license.workspace = true
repository.workspace = true
keywords.workspace = true
documentation.workspace = true
homepage.workspace = true
description = "27+ neural forecasting models for time series prediction - NHITS, LSTM, Transformers, and more"

[lib]
crate-type = ["rlib"]

[dependencies]
# Core numerical computing
ndarray = { version = "0.15", features = ["rayon", "serde"] }
ndarray-linalg = { version = "0.16", features = ["openblas-static"] }
ndarray-rand = "0.14"
ndarray-stats = "0.5"

# Data structures
polars = { workspace = true }

# Serialization
serde = { workspace = true }
serde_json = { workspace = true }
bincode = "1.3"

# Parallel processing
rayon = "1.8"
num_cpus = "1.16"

# Error handling
thiserror = { workspace = true }
anyhow = { workspace = true }

# Async runtime
tokio = { workspace = true }

# Utilities
rand = "0.8"
rand_distr = "0.4"
itertools = "0.12"
chrono = { workspace = true }
uuid = { workspace = true }

# Logging
tracing = { workspace = true }

# Math utilities
num-traits = "0.2"
approx = "0.5"

# Statistics
statrs = "0.16"

# FFT for frequency-domain transformers (FedFormer)
rustfft = "6.1"

# Optional GPU acceleration
candle-core = { version = "0.6", optional = true }
candle-nn = { version = "0.6", optional = true }
cudarc = { version = "0.11", optional = true }

# Internal workspace dependencies
nt-core = { version = "2.0.0", path = "../core" }
nt-neural = { version = "2.0.0", path = "../neural", optional = true }

[dev-dependencies]
criterion = { workspace = true }
proptest = { workspace = true }
approx = "0.5"
tempfile = "3.8"
tokio = { workspace = true }
tracing-subscriber = { version = "0.3", features = ["env-filter"] }

[features]
default = ["cpu", "simd"]
cpu = []
simd = []  # SIMD vectorization (AVX2/NEON)
gpu = ["candle-core", "candle-nn"]
cuda = ["gpu", "cudarc", "candle-core/cuda"]
metal = ["gpu", "candle-core/metal"]
accelerate = ["gpu", "candle-core/accelerate"]
all-models = []
neural = ["nt-neural"]

[[bench]]
name = "simd_benchmarks"
harness = false

[[bench]]
name = "parallel_benchmarks"
harness = false

[[bench]]
name = "mixed_precision_benchmark"
harness = false

[[bench]]
name = "training_benchmarks"
harness = false

[[bench]]
name = "inference_benchmarks"
harness = false

[[bench]]
name = "model_comparison"
harness = false

[[bench]]
name = "optimization_benchmarks"
harness = false
