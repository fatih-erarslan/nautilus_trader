# Neural Trader Benchmark Suite

## Overview

Comprehensive performance benchmarks for critical trading paths using Criterion.rs.

## Benchmark Categories

### 1. Risk Management Benchmarks
**Location:** `crates/risk/benches/`

#### Monte Carlo VaR
- **Scenario:** 10,000 simulations, 3-asset portfolio
- **Target:** < 50ms (99th percentile)
- **Critical Path:** Trading risk assessment

#### Kelly Criterion
- **Scenario:** Multi-asset position sizing
- **Target:** < 1ms
- **Critical Path:** Order sizing calculations

### 2. Order Execution Benchmarks
**Location:** `crates/execution/benches/`

#### Order Processing
- **Scenario:** Market order submission and confirmation
- **Target:** < 100μs (p99)
- **Critical Path:** Trade execution latency

#### Order Book Updates
- **Scenario:** Process 1000 market data updates
- **Target:** < 5ms total
- **Critical Path:** Real-time market data

### 3. Neural Network Benchmarks
**Location:** `crates/neural/benches/`

#### NHITS Inference
- **Scenario:** Single forecast with 168-hour lookback
- **Target:** < 15ms
- **Critical Path:** Price prediction

#### Batch Inference
- **Scenario:** 100 symbols parallel inference
- **Target:** < 500ms
- **Critical Path:** Multi-symbol predictions

### 4. Strategy Benchmarks
**Location:** `crates/strategies/benches/`

#### Signal Generation
- **Scenario:** Momentum strategy on 1000 bars
- **Target:** < 10ms
- **Critical Path:** Trading signals

#### Backtesting
- **Scenario:** 1-year backtest with 10,000 bars
- **Target:** < 2 seconds
- **Critical Path:** Strategy validation

---

## Running Benchmarks

### All Benchmarks
```bash
cd /workspaces/neural-trader/neural-trader-rust
cargo bench --workspace
```

### Specific Category
```bash
# Risk benchmarks only
cargo bench -p nt-risk

# Execution benchmarks
cargo bench -p nt-execution

# Neural benchmarks
cargo bench -p nt-neural
```

### With Flamegraph Profiling
```bash
cargo flamegraph --bench monte_carlo_bench
```

---

## Benchmark Results Template

### Expected Output Format
```
Monte Carlo VaR/10k_sims time: [31.234 ms 31.567 ms 31.912 ms]
                              change: [-1.2345% +0.5678% +2.3456%] (p = 0.12)
                              Performance has not changed.

Kelly Criterion/3_assets time: [892.34 μs 901.23 μs 910.45 μs]
                              change: [-5.234% -3.456% -1.678%] (p < 0.001)
                              Performance has improved.
```

---

## Performance Targets

| Benchmark | Target (p50) | Target (p99) | Status |
|-----------|-------------|--------------|---------|
| Monte Carlo VaR (10k) | 30ms | 50ms | ⏳ TBD |
| Kelly Criterion (3 assets) | 0.8ms | 1.5ms | ⏳ TBD |
| Order Processing | 50μs | 100μs | ⏳ TBD |
| Order Book Update | 5μs | 10μs | ⏳ TBD |
| NHITS Inference | 10ms | 20ms | ⏳ TBD |
| Momentum Signal (1k bars) | 5ms | 12ms | ⏳ TBD |
| Backtest (1 year) | 1.5s | 2.5s | ⏳ TBD |

---

## Optimization Tracking

### Baseline (v0.1.0)
*To be established on first benchmark run*

### Current (v0.1.0 - Optimized)
*Awaiting benchmark execution*

### Target (v1.0.0)
- [ ] All critical paths < p99 targets
- [ ] 30%+ improvement over baseline
- [ ] Zero regression in benchmarks

---

## Continuous Benchmarking

### CI Integration
```yaml
# .github/workflows/benchmark.yml
name: Benchmarks
on:
  pull_request:
    branches: [main]

jobs:
  benchmark:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions-rs/toolchain@v1
      - name: Run benchmarks
        run: cargo bench --workspace
      - name: Compare to baseline
        run: critcmp baseline current
```

### Regression Detection
- Track benchmark history
- Alert on >10% regression
- Block PRs with performance degradation

---

*Generated by Performance Benchmarker Agent*
